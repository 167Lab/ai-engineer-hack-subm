# –ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–ú–ê–°) –¥–ª—è AI Data Engineer

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –∏–Ω–∂–µ–Ω–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—é—â–∞—è:
- –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—é DDL —Å–∫—Ä–∏–ø—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ Airflow –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
backend/apps/agents/
‚îú‚îÄ‚îÄ config/                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ general_config.yaml   # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ prompts/              # –ü—Ä–æ–º–ø—Ç—ã –∞–≥–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ core/                      # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ state.py              # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ llm_manager.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ LLM
‚îÇ   ‚îú‚îÄ‚îÄ agent_executor.py     # –ë–∞–∑–æ–≤—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ graph.py              # LangGraph –≥—Ä–∞—Ñ (—É—Å—Ç–∞—Ä–µ–ª–æ)
‚îú‚îÄ‚îÄ agents/                    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ input_analyzer.py     # –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ ddl_generator.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è DDL
‚îÇ   ‚îú‚îÄ‚îÄ pipeline_generator.py # –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ report_generator.py   # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ tools/                     # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ data_tools.py         # –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ db_tools.py           # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îî‚îÄ‚îÄ integration.py            # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
pip install -r requirements.txt

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –ú–ê–°
pip install langchain langchain-ollama
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ollama (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama
curl -fsSL https://ollama.com/install.sh | sh

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π
ollama pull llama3.2
ollama pull qwen2.5:14b

# –ü—Ä–æ–≤–µ—Ä–∫–∞
ollama list
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `backend/apps/agents/config/general_config.yaml`:

```yaml
llm_config:
  provider: "ollama"
  
  ollama:
    enabled: true
    url: "http://localhost:11434"
    models:
      input_analysis: "qwen2.5:14b"
      ddl_generation: "llama3.2:latest"
```

–î–ª—è –æ–±–ª–∞—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
export GROQ_API_KEY="your_api_key"
export OPENAI_API_KEY="your_api_key"
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
cd backend/apps/agents
python test_mas.py
```

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ Django API

```python
from apps.agents.integration import LLMIntegration

# –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
mas = LLMIntegration()

# –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
request_data = {
    'source_type': 'csv',
    'connection_params': {
        'file_path': '/path/to/data.csv'
    }
}

result = await mas.analyze_data_source(request_data)
```

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º

```python
# –ù–∞—á–∞–ª–æ –∞–Ω–∞–ª–∏–∑–∞
result = await mas.analyze_with_feedback(request_data)
session_id = result['session_id']

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
feedback = {
    'user_feedback': {
        'stage': 'input_analysis',
        'storage_override': 'clickhouse'
    }
}

result = await mas.analyze_with_feedback(feedback, session_id)
```

## üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

- **–§–∞–π–ª—ã**: CSV, JSON, XML
- **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL, ClickHouse
- **–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**: Kafka, HDFS, Spark

## üóÑÔ∏è –¶–µ–ª–µ–≤—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

### PostgreSQL
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- OLTP –Ω–∞–≥—Ä—É–∑–∫–∞
- –°–ª–æ–∂–Ω—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

### ClickHouse
- –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã
- OLAP –Ω–∞–≥—Ä—É–∑–∫–∞

### HDFS
- –ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê—Ä—Ö–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
- Data Lake —Å—Ü–µ–Ω–∞—Ä–∏–∏

## üìä –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã –ú–ê–°

1. **–ê–Ω–∞–ª–∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
   - –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è DDL**
   - –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
   - –ü–∞—Ä—Ç–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏–µ

3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Airflow DAG
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

4. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞**
   - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
   - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- `/backend/apps/agents/logs/` - –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–æ–≤
- `/tmp/mas_temp/` - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- `/tmp/mas_sessions/` - —Å–µ—Å—Å–∏–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤

–ü—Ä–æ–º–ø—Ç—ã –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `config/prompts/`:
- `input_analysis_prompt.yaml` - –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- `ddl_generation_prompt.yaml` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è DDL
- `pipeline_generation_prompt.yaml` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
- `report_generation_prompt.yaml` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤

## üêõ –û—Ç–ª–∞–¥–∫–∞

–í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```yaml
agents_config:
  verbose: true
  save_intermediate: true
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã LLM:
```python
from apps.agents.core import LLMManager

manager = LLMManager()
llm = manager.get_llm('input_analysis')
response = llm.invoke("Test message")
```

## üìù –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- Django 4.2+
- LangChain 0.1+
- LangGraph 0.0.20+
- Pandas, NumPy
- Ollama (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π)

## ü§ù –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

–ú–ê–° –≥–æ—Ç–æ–≤–∞ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Django REST API:

```python
# views.py
from apps.agents.integration import LLMIntegration

class AnalyzeDataSourceView(APIView):
    def post(self, request):
        mas = LLMIntegration()
        result = asyncio.run(
            mas.analyze_data_source(request.data)
        )
        return Response(result)
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [LangGraph –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://langchain-ai.github.io/langgraph/)
- [Ollama —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](https://ollama.com/docs)
- [Apache Airflow](https://airflow.apache.org/docs/)

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Kafka –∏ Spark
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kubernetes
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–æ–≤
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

## üìß –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `/backend/apps/agents/logs/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `general_config.yaml`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test_mas.py`
